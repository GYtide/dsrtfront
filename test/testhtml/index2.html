<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Echarts Custom Series</title>
  <script src="../../src/lib/echarts/echarts.min.js"></script>
</head>

<body>
  <div id="main" style="width: 1600px; height: 1000px;"></div>
  <script type="text/javascript">
    fetch('../../data/2020/image/image.bin', { method: 'get', responseType: 'arraybuffer' }
    ).then(res => {
      return res.arrayBuffer()
    }).then(data => {
      data = new Float32Array(data)

      var valueData = []

      for (let j = 0; j < 128; ++j) {
        for (let i = 0; i < 128; ++i) {
          valueData.push([i, j, data[j * 128 + i]])
        }
      }
      console.log(data)
      var xData = Array.from({ length: 128 }, (_, index) => index + 1);
      var yData = Array.from({ length: 128 }, (_, index) => index + 1);
      var chartDom = document.getElementById('main');
      var myChart = echarts.init(chartDom);
      option = {
        tooltip: {},
        xAxis: {
          type: 'category',
          data: xData
        },
        yAxis: {
          type: 'category',
          data: yData
        },
        visualMap: {
          min: Math.min(...data),
          max: Math.max(...data),
          calculable: true,
          realtime: false,
          inRange: {
            color: [
              'rgb(0,0,0)',
              'rgb(230,0,0)',
              'rgb(255,210,0)',
              'rgb(255,255,255)'
            ]
          }
        },
        series: [
          {
            name: 'Gaussian',
            type: 'heatmap',
            data: valueData,
            emphasis: {
              itemStyle: {
                borderColor: '#333',
                borderWidth: 1
              }
            },
            progressive: 1000,
            animation: false
          }
        ]

      }
      option && myChart.setOption(option);

    })
  </script>
</body>

</html>